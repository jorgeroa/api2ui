# Requirements Archive: v1.4 API Authentication

**Archived:** 2026-02-10
**Status:** SHIPPED

This is the archived requirements specification for v1.4.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: api2ui v1.4

**Defined:** 2026-02-09
**Core Value:** Any API becomes instantly usable through a visual interface — paste a URL, see your data rendered as a real UI.

## v1.4 Requirements

### Auth Store & Credential Management

- [x] **AUTH-01**: Zustand auth store with sessionStorage persistence for credentials (cleared on tab close)
- [x] **AUTH-02**: Per-API credential scoping keyed by base URL (`new URL(url).origin`)
- [x] **AUTH-03**: Support 4 auth types: API Key (header), Bearer Token, Basic Auth, Query Parameter
- [x] **AUTH-04**: Credential clearing per API ("Clear" button removes credentials for current API)
- [x] **AUTH-05**: Credential masking in UI (password input type, values shown as `••••••`)

### Fetch Integration

- [x] **FETCH-01**: `fetchWithAuth` wrapper injects credentials into requests based on auth type
- [x] **FETCH-02**: Bearer Token adds `Authorization: Bearer <token>` header
- [x] **FETCH-03**: Basic Auth adds `Authorization: Basic <base64(user:pass)>` header via btoa()
- [x] **FETCH-04**: API Key adds custom header (configurable name, default `X-API-Key`)
- [x] **FETCH-05**: Query Parameter appends `?<name>=<value>` to URL
- [x] **FETCH-06**: 401/403 responses detected and surfaced as AuthError (distinct from network/CORS errors)
- [x] **FETCH-07**: Unauthenticated APIs continue working with zero behavioral change (no regression)

### Auth Configuration UI

- [x] **UI-01**: Auth panel accessible from settings/config area with "Authorize" button
- [x] **UI-02**: Auth type selector (dropdown/radio) for choosing between 4 auth types
- [x] **UI-03**: Dynamic form fields per auth type (token input, username/password, header name + value, param name + value)
- [x] **UI-04**: Visual lock indicator showing auth state (no auth / active / failed)
- [x] **UI-05**: Auth error display with contextual guidance (401 = check credentials, 403 = insufficient permissions)

### OpenAPI Detection

- [x] **SPEC-01**: Parse `components.securitySchemes` from OpenAPI specs to detect auth requirements
- [x] **SPEC-02**: Map OpenAPI security scheme types to api2ui auth types (apiKey→API Key, http:bearer→Bearer, http:basic→Basic Auth)
- [x] **SPEC-03**: Pre-populate auth type and metadata (header name, parameter name) from spec
- [x] **SPEC-04**: Gracefully skip unsupported schemes (OAuth 2.0, OpenID Connect) with user-visible warning

### Smart Error Handling

- [x] **ERR-01**: Auto-prompt on 401/403: inline UI offering "This API requires authentication. Configure now?"
- [x] **ERR-02**: Clear distinction between 401 (authentication failed) and 403 (authorization denied) messages
- [x] **ERR-03**: No auto-retry on auth failures (show error, let user reconfigure)

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| AUTH-01 | 17 | Complete |
| AUTH-02 | 17 | Complete |
| AUTH-03 | 17 | Complete |
| AUTH-04 | 19 | Complete |
| AUTH-05 | 19 | Complete |
| FETCH-01 | 18 | Complete |
| FETCH-02 | 18 | Complete |
| FETCH-03 | 18 | Complete |
| FETCH-04 | 18 | Complete |
| FETCH-05 | 18 | Complete |
| FETCH-06 | 17 | Complete |
| FETCH-07 | 18 | Complete |
| UI-01 | 19 | Complete |
| UI-02 | 19 | Complete |
| UI-03 | 19 | Complete |
| UI-04 | 19 | Complete |
| UI-05 | 19 | Complete |
| SPEC-01 | 20 | Complete |
| SPEC-02 | 20 | Complete |
| SPEC-03 | 20 | Complete |
| SPEC-04 | 20 | Complete |
| ERR-01 | 21 | Complete |
| ERR-02 | 21 | Complete |
| ERR-03 | 21 | Complete |

## Milestone Summary

**Shipped:** 24 of 24 requirements
**Adjusted:** None
**Dropped:** None

---
*Archived: 2026-02-10 as part of v1.4 milestone completion*
