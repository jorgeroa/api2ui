---
phase: 09-url-parsing-type-inference
plan: 05
type: execute
wave: 2
depends_on: ["09-02"]
files_modified:
  - src/components/forms/ParameterInput.tsx
  - src/components/forms/TypeIcon.tsx
autonomous: true

must_haves:
  truths:
    - "Subtle type icon appears next to input for inferred types"
    - "Icon is clickable with dropdown to change input type"
    - "Date fields show calendar icon, emails show @ symbol, URLs show link icon"
    - "Plain text input is fallback when type can't be inferred"
    - "User can override inferred type via dropdown"
  artifacts:
    - path: "src/components/forms/TypeIcon.tsx"
      provides: "Type icon with override dropdown"
      exports: ["TypeIcon"]
    - path: "src/components/forms/ParameterInput.tsx"
      provides: "Extended input with type icons"
      contains: "TypeIcon"
  key_links:
    - from: "src/components/forms/ParameterInput.tsx"
      to: "TypeIcon component"
      via: "renders TypeIcon next to input"
      pattern: "<TypeIcon"
    - from: "src/components/forms/TypeIcon.tsx"
      to: "@headlessui/react Menu"
      via: "dropdown for type override"
      pattern: "import.*Menu.*from.*@headlessui/react"
---

<objective>
Add type icons to parameter inputs with dropdown for overriding inferred types.

Purpose: Users see visual indicators of detected parameter types (calendar for dates, @ for emails, etc.). When inference is wrong, they can click the icon to change the input type without entering Configure mode.

Output: TypeIcon component with dropdown, integrated into ParameterInput.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-url-parsing-type-inference/09-RESEARCH.md
@.planning/phases/09-url-parsing-type-inference/09-CONTEXT.md

# Existing input component to extend
@src/components/forms/ParameterInput.tsx

# Type inferrer from Plan 02
@src/services/urlParser/typeInferrer.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TypeIcon Component</name>
  <files>src/components/forms/TypeIcon.tsx</files>
  <action>
Create type icon component with dropdown for type override.

**Props interface:**
```typescript
interface TypeIconProps {
  type: string              // Current type (from inference or override)
  onTypeChange: (type: string) => void
  disabled?: boolean        // Disable dropdown in certain contexts
}
```

**Icon mapping (use inline SVG or Heroicons if available):**
- date: Calendar icon (outline)
- email: @ symbol or EnvelopeIcon
- url: Link icon (chain link)
- coordinates: MapPin icon
- zip: Map icon (simple)
- number: Hash/# icon
- boolean: Toggle/switch icon
- string: Text/Aa icon (or no icon - just show dropdown trigger)

**Implementation:**
1. Use Headless UI Menu for dropdown
2. MenuButton shows current type's icon (subtle gray color: text-gray-400)
3. MenuButton has hover state: hover:bg-gray-100 rounded p-1
4. MenuItems dropdown shows all available types with icons and labels
5. MenuItem onClick calls onTypeChange with selected type
6. Active/selected MenuItem highlighted

**Available types for dropdown:**
- string (Text)
- number (Number)
- boolean (Boolean)
- date (Date)
- email (Email)
- url (URL)
- coordinates (Coordinates)
- zip (ZIP Code)

**Styling:**
- Icon size: w-4 h-4
- Icon color: text-gray-400, hover:text-gray-600
- Dropdown: shadow-lg rounded-md bg-white border, positioned right
- Menu items: px-3 py-2 text-sm, hover:bg-gray-50
  </action>
  <verify>
```bash
# Verify file exists and exports component
grep -l "export function TypeIcon" src/components/forms/TypeIcon.tsx
# Verify Menu usage
grep "Menu" src/components/forms/TypeIcon.tsx
```
  </verify>
  <done>
- TypeIcon renders appropriate icon for each type
- Dropdown shows all available types
- onTypeChange called when user selects different type
- Styling matches subtle, non-intrusive design
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate TypeIcon into ParameterInput</name>
  <files>src/components/forms/ParameterInput.tsx</files>
  <action>
Extend ParameterInput to show TypeIcon and support inferred/overridden types.

**New props to add:**
```typescript
interface ParameterInputProps {
  parameter: ParsedParameter
  value: string
  onChange: (value: string) => void
  inferredType?: string           // NEW: Type from inference
  typeOverride?: string           // NEW: User's override (from store)
  onTypeOverride?: (type: string) => void  // NEW: Callback for override
}
```

**Implementation changes:**

1. Determine effective type:
   ```typescript
   const effectiveType = typeOverride ?? inferredType ?? 'string'
   ```

2. Add TypeIcon to input layout:
   - Position: To the right of the label, before the input
   - Only show if inferredType or typeOverride is set
   - Layout: flex items-center gap-2 for label row

3. Update renderInput() to use effectiveType:
   - If effectiveType === 'date' -> render date input
   - If effectiveType === 'email' -> render email input
   - If effectiveType === 'url' -> render url input
   - If effectiveType === 'number' -> render number input
   - If effectiveType === 'boolean' -> render checkbox
   - If effectiveType === 'coordinates' -> render text with coordinate placeholder
   - If effectiveType === 'zip' -> render text with zip pattern
   - Default: text input

4. Wire up onTypeOverride:
   ```tsx
   <TypeIcon
     type={effectiveType}
     onTypeChange={onTypeOverride ?? (() => {})}
     disabled={!onTypeOverride}
   />
   ```

**Backward compatibility:**
- If inferredType/typeOverride/onTypeOverride not provided, component works exactly as before
- Existing usages (from OpenAPI specs with schema.format) continue to work
  </action>
  <verify>
```bash
# Verify TypeIcon import
grep "import.*TypeIcon" src/components/forms/ParameterInput.tsx
# Verify new props exist
grep "inferredType" src/components/forms/ParameterInput.tsx
grep "onTypeOverride" src/components/forms/ParameterInput.tsx
# TypeScript check
npx tsc --noEmit
```
  </verify>
  <done>
- ParameterInput accepts inferredType, typeOverride, onTypeOverride props
- TypeIcon displayed when type inference is present
- Effective type determines input rendering
- Backward compatible with existing usages
  </done>
</task>

</tasks>

<verification>
```bash
# TypeScript compilation
npx tsc --noEmit

# Verify integration
grep -A5 "TypeIcon" src/components/forms/ParameterInput.tsx
```
</verification>

<success_criteria>
- TypeIcon shows appropriate icon for each detected type
- Dropdown allows changing type to any available option
- ParameterInput renders correct input based on effective type
- Backward compatible (existing code without new props still works)
- Subtle, non-intrusive visual design
</success_criteria>

<output>
After completion, create `.planning/phases/09-url-parsing-type-inference/09-05-SUMMARY.md`
</output>
